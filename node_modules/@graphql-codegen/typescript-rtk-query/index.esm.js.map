{"version":3,"file":"index.esm.js","sources":["../../../dist/plugins/typescript/rtk-query/src/visitor.js","../../../dist/plugins/typescript/rtk-query/src/index.js"],"sourcesContent":["import { ClientSideBaseVisitor, getConfigValue, DocumentMode, } from '@graphql-codegen/visitor-plugin-common';\nimport { pascalCase } from 'change-case-all';\nimport autoBind from 'auto-bind';\nexport class RTKQueryVisitor extends ClientSideBaseVisitor {\n    constructor(schema, fragments, rawConfig, documents) {\n        super(schema, fragments, rawConfig, {\n            documentMode: DocumentMode.string,\n            importBaseApiFrom: getConfigValue(rawConfig.importBaseApiFrom, ''),\n            exportHooks: getConfigValue(rawConfig.exportHooks, false),\n        });\n        this.rawConfig = rawConfig;\n        this._endpoints = [];\n        this._hooks = [];\n        this._externalImportPrefix = this.config.importOperationTypesFrom ? `${this.config.importOperationTypesFrom}.` : '';\n        this._documents = documents;\n        autoBind(this);\n    }\n    get imports() {\n        return this._imports;\n    }\n    get hasOperations() {\n        return this._collectedOperations.length > 0;\n    }\n    getImports() {\n        const baseImports = super.getImports();\n        if (!this.hasOperations) {\n            return baseImports;\n        }\n        return [...baseImports, `import { api } from '${this.config.importBaseApiFrom}';`];\n    }\n    getInjectCall() {\n        return (`\nconst injectedRtkApi = api.injectEndpoints({\n  endpoints: (build) => ({${this._endpoints.join('')}\n  }),\n});\n\nexport { injectedRtkApi as api };\n` +\n            (this.config.exportHooks ? `export const { ${this._hooks.join(', ')} } = injectedRtkApi;` : '') +\n            '\\n\\n');\n    }\n    buildOperation(node, documentVariableName, operationType, operationResultType, operationVariablesTypes, hasRequiredVariables) {\n        var _a, _b;\n        operationResultType = this._externalImportPrefix + operationResultType;\n        operationVariablesTypes = this._externalImportPrefix + operationVariablesTypes;\n        const operationName = (_a = node.name) === null || _a === void 0 ? void 0 : _a.value;\n        if (!operationName)\n            return '';\n        const Generics = `${operationResultType}, ${operationVariablesTypes}${hasRequiredVariables ? '' : ' | void'}`;\n        if (operationType === 'Query') {\n            this._endpoints.push(`\n    ${operationName}: build.query<${Generics}>({\n      query: (variables) => ({ document: ${documentVariableName}, variables })\n    }),`);\n            if (this.config.exportHooks) {\n                this._hooks.push(`use${pascalCase(operationName)}Query`);\n                this._hooks.push(`useLazy${pascalCase(operationName)}Query`);\n            }\n        }\n        else if (operationType === 'Mutation') {\n            this._endpoints.push(`\n    ${operationName}: build.mutation<${Generics}>({\n      query: (variables) => ({ document: ${documentVariableName}, variables })\n    }),`);\n            if (this.config.exportHooks) {\n                this._hooks.push(`use${pascalCase(operationName)}Mutation`);\n            }\n        }\n        else if (operationType === 'Subscription') {\n            // eslint-disable-next-line no-console\n            console.warn(`Plugin \"typescript-rtk-query\" does not support GraphQL Subscriptions at the moment! Skipping \"${(_b = node.name) === null || _b === void 0 ? void 0 : _b.value}\"...`);\n        }\n        return '';\n    }\n}\n//# sourceMappingURL=visitor.js.map","import { visit, concatAST, Kind } from 'graphql';\nimport { RTKQueryVisitor } from './visitor';\nimport { extname } from 'path';\nexport const plugin = (schema, documents, config) => {\n    const allAst = concatAST(documents.map(v => v.document));\n    const allFragments = [\n        ...allAst.definitions.filter(d => d.kind === Kind.FRAGMENT_DEFINITION).map(fragmentDef => ({\n            node: fragmentDef,\n            name: fragmentDef.name.value,\n            onType: fragmentDef.typeCondition.name.value,\n            isExternal: false,\n        })),\n        ...(config.externalFragments || []),\n    ];\n    const visitor = new RTKQueryVisitor(schema, allFragments, config, documents);\n    const visitorResult = visit(allAst, { leave: visitor });\n    return {\n        prepend: visitor.getImports(),\n        content: [\n            visitor.fragments,\n            ...visitorResult.definitions.filter(t => typeof t === 'string'),\n            visitor.getInjectCall(),\n        ].join('\\n'),\n    };\n};\nexport const validate = async (schema, documents, config, outputFile) => {\n    if (extname(outputFile) !== '.ts' && extname(outputFile) !== '.tsx') {\n        throw new Error(`Plugin \"typescript-rtk-query\" requires extension to be \".ts\" or \".tsx\"!`);\n    }\n    if (!config.importBaseApiFrom) {\n        throw new Error(`You must specify the \"importBaseApiFrom\" option to use the RTK Query plugin!` + JSON.stringify(config));\n    }\n};\nexport { RTKQueryVisitor };\n//# sourceMappingURL=index.js.map"],"names":[],"mappings":"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"}