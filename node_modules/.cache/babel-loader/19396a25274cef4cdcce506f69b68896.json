{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nakanoteppei/Documents/Jupiter/Codes/bulldogswap.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/nakanoteppei/Documents/Jupiter/Codes/bulldogswap.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/nakanoteppei/Documents/Jupiter/Codes/bulldogswap.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{ThemeContext as _ThemeContext}from\"styled-components\";import _styled from\"styled-components\";import{Trans}from\"@lingui/react\";import{useState,useContext}from'react';import{useActiveWeb3React}from'../../hooks/web3';import{getExplorerLink,ExplorerDataType}from'../../utils/getExplorerLink';import Modal from'../Modal';import{AutoColumn,ColumnCenter}from'../Column';import{RowBetween}from'../Row';import{TYPE,CustomLightSpinner}from'../../theme';import{X,ArrowUpCircle}from'react-feather';import{ButtonPrimary}from'../Button';import Circle from\"../../assets/images/blue-loader.svg\";import{useVoteCallback,useUserVotes}from'../../state/governance/hooks';import{ExternalLink}from'../../theme/components';import{formatCurrencyAmount}from'utils/formatCurrencyAmount';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ContentWrapper=_styled(AutoColumn).withConfig({componentId:\"sc-km2t4x-0\"})([\"width:100%;padding:24px;\"]);var StyledClosed=_styled(X).withConfig({componentId:\"sc-km2t4x-1\"})([\":hover{cursor:pointer;}\"]);var ConfirmOrLoadingWrapper=_styled.div.withConfig({componentId:\"sc-km2t4x-2\"})([\"width:100%;padding:24px;\"]);var ConfirmedIcon=_styled(ColumnCenter).withConfig({componentId:\"sc-km2t4x-3\"})([\"padding:60px 0;\"]);export default function VoteModal(_ref){var isOpen=_ref.isOpen,onDismiss=_ref.onDismiss,proposalId=_ref.proposalId,support=_ref.support;var _useActiveWeb3React=useActiveWeb3React(),chainId=_useActiveWeb3React.chainId;var _useVoteCallback=useVoteCallback(),voteCallback=_useVoteCallback.voteCallback;var _useUserVotes=useUserVotes(),availableVotes=_useUserVotes.votes;// monitor call to help UI loading state\nvar _useState=useState(),_useState2=_slicedToArray(_useState,2),hash=_useState2[0],setHash=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),attempting=_useState4[0],setAttempting=_useState4[1];// get theme for colors\nvar theme=useContext(_ThemeContext);// wrapper to reset state on modal close\nfunction wrappedOndismiss(){setHash(undefined);setAttempting(false);onDismiss();}function onVote(){return _onVote.apply(this,arguments);}function _onVote(){_onVote=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _voteCallback;var hash;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setAttempting(true);// if callback not returned properly ignore\nif(voteCallback){_context.next=3;break;}return _context.abrupt(\"return\");case 3:_context.next=5;return(_voteCallback=voteCallback(proposalId,support))===null||_voteCallback===void 0?void 0:_voteCallback.catch(function(error){setAttempting(false);console.log(error);});case 5:hash=_context.sent;if(hash){setHash(hash);}case 7:case\"end\":return _context.stop();}}},_callee);}));return _onVote.apply(this,arguments);}return/*#__PURE__*/_jsxs(Modal,{isOpen:isOpen,onDismiss:wrappedOndismiss,maxHeight:90,children:[!attempting&&!hash&&/*#__PURE__*/_jsx(ContentWrapper,{gap:\"lg\",children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"lg\",justify:\"center\",children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(TYPE.mediumHeader,{fontWeight:500,children:support?/*#__PURE__*/_jsx(Trans,{id:\"Vote for proposal {proposalId}\",values:{proposalId:proposalId}}):/*#__PURE__*/_jsx(Trans,{id:\"Vote against proposal {proposalId}\",values:{proposalId:proposalId}})}),/*#__PURE__*/_jsx(StyledClosed,{stroke:\"black\",onClick:wrappedOndismiss})]}),/*#__PURE__*/_jsx(TYPE.largeHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"{0} Votes\",values:{0:formatCurrencyAmount(availableVotes,4)}})}),/*#__PURE__*/_jsx(ButtonPrimary,{onClick:onVote,children:/*#__PURE__*/_jsx(TYPE.mediumHeader,{color:\"white\",children:support?/*#__PURE__*/_jsx(Trans,{id:\"Vote for proposal {proposalId}\",values:{proposalId:proposalId}}):/*#__PURE__*/_jsx(Trans,{id:\"Vote against proposal {proposalId}\",values:{proposalId:proposalId}})})})]})}),attempting&&!hash&&/*#__PURE__*/_jsxs(ConfirmOrLoadingWrapper,{children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsx(StyledClosed,{onClick:wrappedOndismiss})]}),/*#__PURE__*/_jsx(ConfirmedIcon,{children:/*#__PURE__*/_jsx(CustomLightSpinner,{src:Circle,alt:\"loader\",size:'90px'})}),/*#__PURE__*/_jsxs(AutoColumn,{gap:\"100px\",justify:'center',children:[/*#__PURE__*/_jsx(AutoColumn,{gap:\"12px\",justify:'center',children:/*#__PURE__*/_jsx(TYPE.largeHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"Submitting Vote\"})})}),/*#__PURE__*/_jsx(TYPE.subHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"Confirm this transaction in your wallet\"})})]})]}),hash&&/*#__PURE__*/_jsxs(ConfirmOrLoadingWrapper,{children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsx(StyledClosed,{onClick:wrappedOndismiss})]}),/*#__PURE__*/_jsx(ConfirmedIcon,{children:/*#__PURE__*/_jsx(ArrowUpCircle,{strokeWidth:0.5,size:90,color:theme.primary1})}),/*#__PURE__*/_jsxs(AutoColumn,{gap:\"100px\",justify:'center',children:[/*#__PURE__*/_jsx(AutoColumn,{gap:\"12px\",justify:'center',children:/*#__PURE__*/_jsx(TYPE.largeHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"Transaction Submitted\"})})}),chainId&&/*#__PURE__*/_jsx(ExternalLink,{href:getExplorerLink(chainId,hash,ExplorerDataType.TRANSACTION),style:{marginLeft:'4px'},children:/*#__PURE__*/_jsx(TYPE.subHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"View transaction on Explorer\"})})})]})]})]});}","map":{"version":3,"sources":["/Users/nakanoteppei/Documents/Jupiter/Codes/bulldogswap.github.io/src/components/vote/VoteModal.tsx"],"names":["useState","useContext","useActiveWeb3React","getExplorerLink","ExplorerDataType","Modal","AutoColumn","ColumnCenter","RowBetween","TYPE","CustomLightSpinner","X","ArrowUpCircle","ButtonPrimary","useVoteCallback","useUserVotes","ExternalLink","formatCurrencyAmount","ContentWrapper","styled","StyledClosed","ConfirmOrLoadingWrapper","div","ConfirmedIcon","VoteModal","isOpen","onDismiss","proposalId","support","chainId","voteCallback","availableVotes","votes","hash","setHash","attempting","setAttempting","theme","ThemeContext","wrappedOndismiss","undefined","onVote","catch","error","console","log","Circle","primary1","TRANSACTION","marginLeft"],"mappings":"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","sourcesContent":["import { useState, useContext } from 'react'\nimport { useActiveWeb3React } from '../../hooks/web3'\nimport { getExplorerLink, ExplorerDataType } from '../../utils/getExplorerLink'\n\nimport Modal from '../Modal'\nimport { AutoColumn, ColumnCenter } from '../Column'\nimport styled, { ThemeContext } from 'styled-components/macro'\nimport { RowBetween } from '../Row'\nimport { TYPE, CustomLightSpinner } from '../../theme'\nimport { X, ArrowUpCircle } from 'react-feather'\nimport { ButtonPrimary } from '../Button'\nimport Circle from '../../assets/images/blue-loader.svg'\nimport { useVoteCallback, useUserVotes } from '../../state/governance/hooks'\nimport { ExternalLink } from '../../theme/components'\nimport { formatCurrencyAmount } from 'utils/formatCurrencyAmount'\nimport { Trans } from '@lingui/macro'\n\nconst ContentWrapper = styled(AutoColumn)`\n  width: 100%;\n  padding: 24px;\n`\n\nconst StyledClosed = styled(X)`\n  :hover {\n    cursor: pointer;\n  }\n`\n\nconst ConfirmOrLoadingWrapper = styled.div`\n  width: 100%;\n  padding: 24px;\n`\n\nconst ConfirmedIcon = styled(ColumnCenter)`\n  padding: 60px 0;\n`\n\ninterface VoteModalProps {\n  isOpen: boolean\n  onDismiss: () => void\n  support: boolean // if user is for or against proposal\n  proposalId: string | undefined // id for the proposal to vote on\n}\n\nexport default function VoteModal({ isOpen, onDismiss, proposalId, support }: VoteModalProps) {\n  const { chainId } = useActiveWeb3React()\n  const {\n    voteCallback,\n  }: {\n    voteCallback: (proposalId: string | undefined, support: boolean) => Promise<string> | undefined\n  } = useVoteCallback()\n  const { votes: availableVotes } = useUserVotes()\n\n  // monitor call to help UI loading state\n  const [hash, setHash] = useState<string | undefined>()\n  const [attempting, setAttempting] = useState<boolean>(false)\n\n  // get theme for colors\n  const theme = useContext(ThemeContext)\n\n  // wrapper to reset state on modal close\n  function wrappedOndismiss() {\n    setHash(undefined)\n    setAttempting(false)\n    onDismiss()\n  }\n\n  async function onVote() {\n    setAttempting(true)\n\n    // if callback not returned properly ignore\n    if (!voteCallback) return\n\n    // try delegation and store hash\n    const hash = await voteCallback(proposalId, support)?.catch((error) => {\n      setAttempting(false)\n      console.log(error)\n    })\n\n    if (hash) {\n      setHash(hash)\n    }\n  }\n\n  return (\n    <Modal isOpen={isOpen} onDismiss={wrappedOndismiss} maxHeight={90}>\n      {!attempting && !hash && (\n        <ContentWrapper gap=\"lg\">\n          <AutoColumn gap=\"lg\" justify=\"center\">\n            <RowBetween>\n              <TYPE.mediumHeader fontWeight={500}>\n                {support ? (\n                  <Trans>Vote for proposal {proposalId}</Trans>\n                ) : (\n                  <Trans>Vote against proposal {proposalId}</Trans>\n                )}\n              </TYPE.mediumHeader>\n              <StyledClosed stroke=\"black\" onClick={wrappedOndismiss} />\n            </RowBetween>\n            <TYPE.largeHeader>\n              <Trans>{formatCurrencyAmount(availableVotes, 4)} Votes</Trans>\n            </TYPE.largeHeader>\n            <ButtonPrimary onClick={onVote}>\n              <TYPE.mediumHeader color=\"white\">\n                {support ? (\n                  <Trans>Vote for proposal {proposalId}</Trans>\n                ) : (\n                  <Trans>Vote against proposal {proposalId}</Trans>\n                )}\n              </TYPE.mediumHeader>\n            </ButtonPrimary>\n          </AutoColumn>\n        </ContentWrapper>\n      )}\n      {attempting && !hash && (\n        <ConfirmOrLoadingWrapper>\n          <RowBetween>\n            <div />\n            <StyledClosed onClick={wrappedOndismiss} />\n          </RowBetween>\n          <ConfirmedIcon>\n            <CustomLightSpinner src={Circle} alt=\"loader\" size={'90px'} />\n          </ConfirmedIcon>\n          <AutoColumn gap=\"100px\" justify={'center'}>\n            <AutoColumn gap=\"12px\" justify={'center'}>\n              <TYPE.largeHeader>\n                <Trans>Submitting Vote</Trans>\n              </TYPE.largeHeader>\n            </AutoColumn>\n            <TYPE.subHeader>\n              <Trans>Confirm this transaction in your wallet</Trans>\n            </TYPE.subHeader>\n          </AutoColumn>\n        </ConfirmOrLoadingWrapper>\n      )}\n      {hash && (\n        <ConfirmOrLoadingWrapper>\n          <RowBetween>\n            <div />\n            <StyledClosed onClick={wrappedOndismiss} />\n          </RowBetween>\n          <ConfirmedIcon>\n            <ArrowUpCircle strokeWidth={0.5} size={90} color={theme.primary1} />\n          </ConfirmedIcon>\n          <AutoColumn gap=\"100px\" justify={'center'}>\n            <AutoColumn gap=\"12px\" justify={'center'}>\n              <TYPE.largeHeader>\n                <Trans>Transaction Submitted</Trans>\n              </TYPE.largeHeader>\n            </AutoColumn>\n            {chainId && (\n              <ExternalLink\n                href={getExplorerLink(chainId, hash, ExplorerDataType.TRANSACTION)}\n                style={{ marginLeft: '4px' }}\n              >\n                <TYPE.subHeader>\n                  <Trans>View transaction on Explorer</Trans>\n                </TYPE.subHeader>\n              </ExternalLink>\n            )}\n          </AutoColumn>\n        </ConfirmOrLoadingWrapper>\n      )}\n    </Modal>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}