{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nakanoteppei/Documents/Jupiter/Codes/bulldogswap.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/nakanoteppei/Documents/Jupiter/Codes/bulldogswap.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/nakanoteppei/Documents/Jupiter/Codes/bulldogswap.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _styled from\"styled-components\";import{Trans}from\"@lingui/react\";import{useState}from'react';import{UNI}from'../../constants/tokens';import Modal from'../Modal';import{AutoColumn}from'../Column';import{RowBetween}from'../Row';import{TYPE}from'../../theme';import{X}from'react-feather';import{ButtonPrimary}from'../Button';import{useActiveWeb3React}from'../../hooks/web3';import AddressInputPanel from'../AddressInputPanel';import{isAddress}from'ethers/lib/utils';import useENS from'../../hooks/useENS';import{useDelegateCallback}from'../../state/governance/hooks';import{useTokenBalance}from'../../state/wallet/hooks';import{LoadingView,SubmittedView}from'../ModalViews';import{formatCurrencyAmount}from'utils/formatCurrencyAmount';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ContentWrapper=_styled(AutoColumn).withConfig({componentId:\"sc-1t2p2c9-0\"})([\"width:100%;padding:24px;\"]);var StyledClosed=_styled(X).withConfig({componentId:\"sc-1t2p2c9-1\"})([\":hover{cursor:pointer;}\"]);var TextButton=_styled.div.withConfig({componentId:\"sc-1t2p2c9-2\"})([\":hover{cursor:pointer;}\"]);export default function DelegateModal(_ref){var isOpen=_ref.isOpen,onDismiss=_ref.onDismiss,title=_ref.title;var _useActiveWeb3React=useActiveWeb3React(),account=_useActiveWeb3React.account,chainId=_useActiveWeb3React.chainId;// state for delegate input\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),usingDelegate=_useState2[0],setUsingDelegate=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),typed=_useState4[0],setTyped=_useState4[1];function handleRecipientType(val){setTyped(val);}// monitor for self delegation or input for third part delegate\n// default is self delegation\nvar activeDelegate=usingDelegate?typed:account;var _useENS=useENS(activeDelegate),parsedAddress=_useENS.address;// get the number of votes available to delegate\nvar uniBalance=useTokenBalance(account!==null&&account!==void 0?account:undefined,chainId?UNI[chainId]:undefined);var delegateCallback=useDelegateCallback();// monitor call to help UI loading state\nvar _useState5=useState(),_useState6=_slicedToArray(_useState5,2),hash=_useState6[0],setHash=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),attempting=_useState8[0],setAttempting=_useState8[1];// wrapper to reset state on modal close\nfunction wrappedOndismiss(){setHash(undefined);setAttempting(false);onDismiss();}function onDelegate(){return _onDelegate.apply(this,arguments);}function _onDelegate(){_onDelegate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _delegateCallback;var hash;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setAttempting(true);// if callback not returned properly ignore\nif(delegateCallback){_context.next=3;break;}return _context.abrupt(\"return\");case 3:_context.next=5;return(_delegateCallback=delegateCallback(parsedAddress!==null&&parsedAddress!==void 0?parsedAddress:undefined))===null||_delegateCallback===void 0?void 0:_delegateCallback.catch(function(error){setAttempting(false);console.log(error);});case 5:hash=_context.sent;if(hash){setHash(hash);}case 7:case\"end\":return _context.stop();}}},_callee);}));return _onDelegate.apply(this,arguments);}return/*#__PURE__*/_jsxs(Modal,{isOpen:isOpen,onDismiss:wrappedOndismiss,maxHeight:90,children:[!attempting&&!hash&&/*#__PURE__*/_jsx(ContentWrapper,{gap:\"lg\",children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"lg\",justify:\"center\",children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(TYPE.mediumHeader,{fontWeight:500,children:title}),/*#__PURE__*/_jsx(StyledClosed,{stroke:\"black\",onClick:wrappedOndismiss})]}),/*#__PURE__*/_jsx(TYPE.body,{children:/*#__PURE__*/_jsx(Trans,{id:\"Earned UNI tokens represent voting shares in Uniswap governance.\"})}),/*#__PURE__*/_jsx(TYPE.body,{children:/*#__PURE__*/_jsx(Trans,{id:\"You can either vote on each proposal yourself or delegate your votes to a third party.\"})}),usingDelegate&&/*#__PURE__*/_jsx(AddressInputPanel,{value:typed,onChange:handleRecipientType}),/*#__PURE__*/_jsx(ButtonPrimary,{disabled:!isAddress(parsedAddress!==null&&parsedAddress!==void 0?parsedAddress:''),onClick:onDelegate,children:/*#__PURE__*/_jsx(TYPE.mediumHeader,{color:\"white\",children:usingDelegate?/*#__PURE__*/_jsx(Trans,{id:\"Delegate Votes\"}):/*#__PURE__*/_jsx(Trans,{id:\"Self Delegate\"})})}),/*#__PURE__*/_jsx(TextButton,{onClick:function onClick(){return setUsingDelegate(!usingDelegate);},children:/*#__PURE__*/_jsx(TYPE.blue,{children:usingDelegate?/*#__PURE__*/_jsx(Trans,{id:\"Remove Delegate\"}):/*#__PURE__*/_jsx(Trans,{id:\"Add Delegate +\"})})})]})}),attempting&&!hash&&/*#__PURE__*/_jsx(LoadingView,{onDismiss:wrappedOndismiss,children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"12px\",justify:'center',children:[/*#__PURE__*/_jsx(TYPE.largeHeader,{children:usingDelegate?/*#__PURE__*/_jsx(Trans,{id:\"Delegating votes\"}):/*#__PURE__*/_jsx(Trans,{id:\"Unlocking Votes\"})}),/*#__PURE__*/_jsxs(TYPE.main,{fontSize:36,children:[\" \",formatCurrencyAmount(uniBalance,4)]})]})}),hash&&/*#__PURE__*/_jsx(SubmittedView,{onDismiss:wrappedOndismiss,hash:hash,children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"12px\",justify:'center',children:[/*#__PURE__*/_jsx(TYPE.largeHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"Transaction Submitted\"})}),/*#__PURE__*/_jsx(TYPE.main,{fontSize:36,children:formatCurrencyAmount(uniBalance,4)})]})})]});}","map":{"version":3,"sources":["/Users/nakanoteppei/Documents/Jupiter/Codes/bulldogswap.github.io/src/components/vote/DelegateModal.tsx"],"names":["useState","UNI","Modal","AutoColumn","RowBetween","TYPE","X","ButtonPrimary","useActiveWeb3React","AddressInputPanel","isAddress","useENS","useDelegateCallback","useTokenBalance","LoadingView","SubmittedView","formatCurrencyAmount","ContentWrapper","styled","StyledClosed","TextButton","div","DelegateModal","isOpen","onDismiss","title","account","chainId","usingDelegate","setUsingDelegate","typed","setTyped","handleRecipientType","val","activeDelegate","parsedAddress","address","uniBalance","undefined","delegateCallback","hash","setHash","attempting","setAttempting","wrappedOndismiss","onDelegate","catch","error","console","log"],"mappings":"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","sourcesContent":["import { ReactNode, useState } from 'react'\nimport { UNI } from '../../constants/tokens'\n\nimport Modal from '../Modal'\nimport { AutoColumn } from '../Column'\nimport styled from 'styled-components/macro'\nimport { RowBetween } from '../Row'\nimport { TYPE } from '../../theme'\nimport { X } from 'react-feather'\nimport { ButtonPrimary } from '../Button'\nimport { useActiveWeb3React } from '../../hooks/web3'\nimport AddressInputPanel from '../AddressInputPanel'\nimport { isAddress } from 'ethers/lib/utils'\nimport useENS from '../../hooks/useENS'\nimport { useDelegateCallback } from '../../state/governance/hooks'\nimport { useTokenBalance } from '../../state/wallet/hooks'\nimport { LoadingView, SubmittedView } from '../ModalViews'\nimport { formatCurrencyAmount } from 'utils/formatCurrencyAmount'\nimport { Trans } from '@lingui/macro'\n\nconst ContentWrapper = styled(AutoColumn)`\n  width: 100%;\n  padding: 24px;\n`\n\nconst StyledClosed = styled(X)`\n  :hover {\n    cursor: pointer;\n  }\n`\n\nconst TextButton = styled.div`\n  :hover {\n    cursor: pointer;\n  }\n`\n\ninterface VoteModalProps {\n  isOpen: boolean\n  onDismiss: () => void\n  title: ReactNode\n}\n\nexport default function DelegateModal({ isOpen, onDismiss, title }: VoteModalProps) {\n  const { account, chainId } = useActiveWeb3React()\n\n  // state for delegate input\n  const [usingDelegate, setUsingDelegate] = useState(false)\n  const [typed, setTyped] = useState('')\n  function handleRecipientType(val: string) {\n    setTyped(val)\n  }\n\n  // monitor for self delegation or input for third part delegate\n  // default is self delegation\n  const activeDelegate = usingDelegate ? typed : account\n  const { address: parsedAddress } = useENS(activeDelegate)\n\n  // get the number of votes available to delegate\n  const uniBalance = useTokenBalance(account ?? undefined, chainId ? UNI[chainId] : undefined)\n\n  const delegateCallback = useDelegateCallback()\n\n  // monitor call to help UI loading state\n  const [hash, setHash] = useState<string | undefined>()\n  const [attempting, setAttempting] = useState(false)\n\n  // wrapper to reset state on modal close\n  function wrappedOndismiss() {\n    setHash(undefined)\n    setAttempting(false)\n    onDismiss()\n  }\n\n  async function onDelegate() {\n    setAttempting(true)\n\n    // if callback not returned properly ignore\n    if (!delegateCallback) return\n\n    // try delegation and store hash\n    const hash = await delegateCallback(parsedAddress ?? undefined)?.catch((error) => {\n      setAttempting(false)\n      console.log(error)\n    })\n\n    if (hash) {\n      setHash(hash)\n    }\n  }\n\n  return (\n    <Modal isOpen={isOpen} onDismiss={wrappedOndismiss} maxHeight={90}>\n      {!attempting && !hash && (\n        <ContentWrapper gap=\"lg\">\n          <AutoColumn gap=\"lg\" justify=\"center\">\n            <RowBetween>\n              <TYPE.mediumHeader fontWeight={500}>{title}</TYPE.mediumHeader>\n              <StyledClosed stroke=\"black\" onClick={wrappedOndismiss} />\n            </RowBetween>\n            <TYPE.body>\n              <Trans>Earned UNI tokens represent voting shares in Uniswap governance.</Trans>\n            </TYPE.body>\n            <TYPE.body>\n              <Trans>You can either vote on each proposal yourself or delegate your votes to a third party.</Trans>\n            </TYPE.body>\n            {usingDelegate && <AddressInputPanel value={typed} onChange={handleRecipientType} />}\n            <ButtonPrimary disabled={!isAddress(parsedAddress ?? '')} onClick={onDelegate}>\n              <TYPE.mediumHeader color=\"white\">\n                {usingDelegate ? <Trans>Delegate Votes</Trans> : <Trans>Self Delegate</Trans>}\n              </TYPE.mediumHeader>\n            </ButtonPrimary>\n            <TextButton onClick={() => setUsingDelegate(!usingDelegate)}>\n              <TYPE.blue>{usingDelegate ? <Trans>Remove Delegate</Trans> : <Trans>Add Delegate +</Trans>}</TYPE.blue>\n            </TextButton>\n          </AutoColumn>\n        </ContentWrapper>\n      )}\n      {attempting && !hash && (\n        <LoadingView onDismiss={wrappedOndismiss}>\n          <AutoColumn gap=\"12px\" justify={'center'}>\n            <TYPE.largeHeader>\n              {usingDelegate ? <Trans>Delegating votes</Trans> : <Trans>Unlocking Votes</Trans>}\n            </TYPE.largeHeader>\n            <TYPE.main fontSize={36}> {formatCurrencyAmount(uniBalance, 4)}</TYPE.main>\n          </AutoColumn>\n        </LoadingView>\n      )}\n      {hash && (\n        <SubmittedView onDismiss={wrappedOndismiss} hash={hash}>\n          <AutoColumn gap=\"12px\" justify={'center'}>\n            <TYPE.largeHeader>\n              <Trans>Transaction Submitted</Trans>\n            </TYPE.largeHeader>\n            <TYPE.main fontSize={36}>{formatCurrencyAmount(uniBalance, 4)}</TYPE.main>\n          </AutoColumn>\n        </SubmittedView>\n      )}\n    </Modal>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}